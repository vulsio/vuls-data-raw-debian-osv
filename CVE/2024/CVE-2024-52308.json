{
	"schema_version": "1.6.0",
	"id": "CVE-2024-52308",
	"modified": "2024-11-19T17:42:37.881185Z",
	"published": "2024-11-14T23:15:05Z",
	"aliases": [
		"GHSA-p2h2-3vg9-4p87",
		"GO-2024-3269"
	],
	"related": [
		"CGA-9p6q-rr9m-xvc9",
		"UBUNTU-CVE-2024-52308"
	],
	"details": "The GitHub CLI version 2.6.1 and earlier are vulnerable to remote code execution through a malicious codespace SSH server when using `gh codespace ssh` or `gh codespace logs` commands. This has been patched in the cli v2.62.0.\n\nDevelopers connect to remote codespaces through an SSH server running within the devcontainer, which is generally provided through the [default devcontainer image]( https://docs.github.com/en/codespaces/setting-up-your-project-for-codespaces/adding-a-dev-container-... https://docs.github.com/en/codespaces/setting-up-your-project-for-codespaces/adding-a-dev-container-configuration/introduction-to-dev-containers#using-the-default-dev-container-configuration) . GitHub CLI [retrieves SSH connection details]( https://github.com/cli/cli/blob/30066b0042d0c5928d959e288144300cb28196c9/internal/codespaces/rpc/inv... https://github.com/cli/cli/blob/30066b0042d0c5928d959e288144300cb28196c9/internal/codespaces/rpc/invoker.go#L230-L244 ), such as remote username, which is used in [executing `ssh` commands]( https://github.com/cli/cli/blob/e356c69a6f0125cfaac782c35acf77314f18908d/pkg/cmd/codespace/ssh.go#L2... https://github.com/cli/cli/blob/e356c69a6f0125cfaac782c35acf77314f18908d/pkg/cmd/codespace/ssh.go#L263 ) for `gh codespace ssh` or `gh codespace logs` commands.\n\nThis exploit occurs when a malicious third-party devcontainer contains a modified SSH server that injects `ssh` arguments within the SSH connection details. `gh codespace ssh` and `gh codespace logs` commands could execute arbitrary code on the user's workstation if the remote username contains something like `-oProxyCommand=\"echo hacked\" #`.  The `-oProxyCommand` flag causes `ssh` to execute the provided command while `#` shell comment causes any other `ssh` arguments to be ignored.\n\nIn `2.62.0`, the remote username information is being validated before being used.",
	"affected": [
		{
			"package": {
				"ecosystem": "Debian:12",
				"name": "gh",
				"purl": "pkg:deb/debian/gh?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						}
					]
				}
			],
			"versions": [
				"2.23.0+dfsg1-1",
				"2.24.3+dfsg1-1",
				"2.27.0+dfsg1-1",
				"2.30.0-1",
				"2.30.0-2",
				"2.35.0-1",
				"2.40.1+dfsg1-1",
				"2.42.1-1",
				"2.43.1-1",
				"2.44.1-1",
				"2.44.1-2",
				"2.45.0-1",
				"2.46.0-1"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-52308.json"
			}
		},
		{
			"package": {
				"ecosystem": "Debian:13",
				"name": "gh",
				"purl": "pkg:deb/debian/gh?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						}
					]
				}
			],
			"versions": [
				"2.23.0+dfsg1-1",
				"2.24.3+dfsg1-1",
				"2.27.0+dfsg1-1",
				"2.30.0-1",
				"2.30.0-2",
				"2.35.0-1",
				"2.40.1+dfsg1-1",
				"2.42.1-1",
				"2.43.1-1",
				"2.44.1-1",
				"2.44.1-2",
				"2.45.0-1",
				"2.46.0-1"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-52308.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://github.com/cli/cli/security/advisories/GHSA-p2h2-3vg9-4p87"
		},
		{
			"type": "ADVISORY",
			"url": "https://security-tracker.debian.org/tracker/CVE-2024-52308"
		}
	]
}
