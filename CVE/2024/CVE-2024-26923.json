{
	"schema_version": "1.6.0",
	"id": "CVE-2024-26923",
	"modified": "2025-01-14T12:13:11.648677Z",
	"published": "2024-04-25T06:15:57Z",
	"aliases": [
		"A-336268889",
		"ASB-A-336268889"
	],
	"related": [
		"ALSA-2024:7000",
		"ALSA-2024:7001",
		"ALSA-2024:8617",
		"DLA-3840-1",
		"DLA-3842-1",
		"DSA-5680-1",
		"DSA-5681-1",
		"RHSA-2024:4823",
		"RHSA-2024:4831",
		"RHSA-2024:6993",
		"RHSA-2024:7000",
		"RHSA-2024:7001",
		"RHSA-2024:7486",
		"RHSA-2024:8617",
		"RLSA-2024:7001",
		"RLSA-2024:8617",
		"SUSE-SU-2024:2135-1",
		"SUSE-SU-2024:2203-1",
		"SUSE-SU-2024:2326-1",
		"SUSE-SU-2024:2335-1",
		"SUSE-SU-2024:2337-1",
		"SUSE-SU-2024:2338-1",
		"SUSE-SU-2024:2341-1",
		"SUSE-SU-2024:2342-1",
		"SUSE-SU-2024:2343-1",
		"SUSE-SU-2024:2344-1",
		"SUSE-SU-2024:2351-1",
		"SUSE-SU-2024:2357-1",
		"SUSE-SU-2024:2358-1",
		"SUSE-SU-2024:2360-1",
		"SUSE-SU-2024:2362-1",
		"SUSE-SU-2024:2365-1",
		"SUSE-SU-2024:2368-1",
		"SUSE-SU-2024:2369-1",
		"SUSE-SU-2024:2372-1",
		"SUSE-SU-2024:2373-1",
		"SUSE-SU-2024:2382-1",
		"SUSE-SU-2024:2394-1",
		"SUSE-SU-2024:2396-1",
		"SUSE-SU-2024:2407-1",
		"SUSE-SU-2024:2410-1",
		"SUSE-SU-2024:2411-1",
		"SUSE-SU-2024:2437-1",
		"SUSE-SU-2024:2446-1",
		"SUSE-SU-2024:2447-1",
		"SUSE-SU-2024:2448-1",
		"SUSE-SU-2024:2449-1",
		"SUSE-SU-2024:2472-1",
		"SUSE-SU-2024:2473-1",
		"SUSE-SU-2024:2474-1",
		"SUSE-SU-2024:2480-1",
		"SUSE-SU-2024:2487-1",
		"SUSE-SU-2024:2488-1",
		"SUSE-SU-2024:2495-1",
		"SUSE-SU-2024:2530-1",
		"SUSE-SU-2024:2549-1",
		"SUSE-SU-2024:2558-1",
		"SUSE-SU-2024:2559-1",
		"SUSE-SU-2024:2561-1",
		"SUSE-SU-2024:2722-1",
		"SUSE-SU-2024:2723-1",
		"SUSE-SU-2024:2725-1",
		"SUSE-SU-2024:2726-1",
		"SUSE-SU-2024:2740-1",
		"SUSE-SU-2024:2751-1",
		"SUSE-SU-2024:2755-1",
		"SUSE-SU-2024:2758-1",
		"SUSE-SU-2024:2759-1",
		"SUSE-SU-2024:2773-1",
		"SUSE-SU-2024:2792-1",
		"SUSE-SU-2024:2797-1",
		"SUSE-SU-2024:2821-1",
		"SUSE-SU-2024:2822-1",
		"SUSE-SU-2024:2823-1",
		"SUSE-SU-2024:2824-1",
		"SUSE-SU-2024:2825-1",
		"SUSE-SU-2024:2840-1",
		"SUSE-SU-2024:2841-1",
		"SUSE-SU-2024:2843-1",
		"SUSE-SU-2024:2850-1",
		"SUSE-SU-2024:2851-1",
		"SUSE-SU-2024:2852-1",
		"SUSE-SU-2024:2853-1",
		"SUSE-SU-2024:2874-1",
		"SUSE-SU-2024:2895-1",
		"SUSE-SU-2024:2939-1",
		"SUSE-SU-2024:2973-1",
		"SUSE-SU-2024:3015-1",
		"SUSE-SU-2024:3034-1",
		"SUSE-SU-2024:3037-1",
		"SUSE-SU-2024:3039-1",
		"SUSE-SU-2024:3043-1",
		"SUSE-SU-2024:3044-1",
		"SUSE-SU-2024:3048-1",
		"SUSE-SU-2024:3318-1",
		"SUSE-SU-2024:3319-1",
		"SUSE-SU-2024:3320-1",
		"SUSE-SU-2024:3334-1",
		"SUSE-SU-2024:3336-1",
		"SUSE-SU-2024:3347-1",
		"SUSE-SU-2024:3348-1",
		"SUSE-SU-2024:3349-1",
		"SUSE-SU-2024:3350-1",
		"SUSE-SU-2024:3363-1",
		"SUSE-SU-2024:3365-1",
		"SUSE-SU-2024:3368-1",
		"SUSE-SU-2024:3370-1",
		"SUSE-SU-2024:3375-1",
		"SUSE-SU-2024:3379-1",
		"SUSE-SU-2024:3399-1",
		"SUSE-SU-2024:3623-1",
		"SUSE-SU-2024:3625-1",
		"SUSE-SU-2024:3631-1",
		"SUSE-SU-2024:3632-1",
		"SUSE-SU-2024:3636-1",
		"SUSE-SU-2024:3639-1",
		"SUSE-SU-2024:3642-1",
		"SUSE-SU-2024:3649-1",
		"SUSE-SU-2024:3651-1",
		"SUSE-SU-2024:3652-1",
		"SUSE-SU-2024:3661-1",
		"SUSE-SU-2024:3662-1",
		"SUSE-SU-2024:3663-1",
		"SUSE-SU-2024:3672-1",
		"SUSE-SU-2024:3674-1",
		"SUSE-SU-2024:3676-1",
		"SUSE-SU-2024:3679-1",
		"SUSE-SU-2024:3685-1",
		"SUSE-SU-2024:3694-1",
		"SUSE-SU-2024:3695-1",
		"SUSE-SU-2024:3696-1",
		"SUSE-SU-2024:3697-1",
		"SUSE-SU-2024:3700-1",
		"SUSE-SU-2024:3701-1",
		"SUSE-SU-2024:3702-1",
		"SUSE-SU-2024:3710-1",
		"SUSE-SU-2024:3774-1",
		"SUSE-SU-2024:3780-1",
		"SUSE-SU-2024:3793-1",
		"SUSE-SU-2024:3796-1",
		"SUSE-SU-2024:3798-1",
		"SUSE-SU-2024:3800-1",
		"SUSE-SU-2024:3803-1",
		"SUSE-SU-2024:3806-1",
		"SUSE-SU-2024:3814-1",
		"SUSE-SU-2024:3815-1",
		"SUSE-SU-2024:3820-1",
		"SUSE-SU-2024:3821-1",
		"SUSE-SU-2024:3822-1",
		"SUSE-SU-2024:3829-1",
		"SUSE-SU-2024:3830-1",
		"SUSE-SU-2024:3831-1",
		"SUSE-SU-2024:3833-1",
		"SUSE-SU-2024:3837-1",
		"SUSE-SU-2024:3840-1",
		"SUSE-SU-2024:3842-1",
		"SUSE-SU-2024:3849-1",
		"SUSE-SU-2024:3851-1",
		"SUSE-SU-2024:3852-1",
		"SUSE-SU-2024:3854-1",
		"SUSE-SU-2024:3855-1",
		"SUSE-SU-2024:3857-1",
		"SUSE-SU-2024:3860-1",
		"SUSE-SU-2024:4180-1",
		"SUSE-SU-2024:4207-1",
		"SUSE-SU-2024:4214-1",
		"SUSE-SU-2024:4216-1",
		"SUSE-SU-2024:4218-1",
		"SUSE-SU-2024:4246-1",
		"SUSE-SU-2024:4249-1",
		"SUSE-SU-2024:4250-1",
		"SUSE-SU-2024:4256-1",
		"SUSE-SU-2025:0091-1",
		"SUSE-SU-2025:0097-1",
		"SUSE-SU-2025:0101-1",
		"SUSE-SU-2025:0103-1",
		"SUSE-SU-2025:0106-1",
		"SUSE-SU-2025:0107-1",
		"SUSE-SU-2025:0109-1",
		"SUSE-SU-2025:0110-1",
		"SUSE-SU-2025:0114-1",
		"SUSE-SU-2025:0115-1",
		"UBUNTU-CVE-2024-26923",
		"USN-6893-1",
		"USN-6893-2",
		"USN-6893-3",
		"USN-6895-1",
		"USN-6895-2",
		"USN-6895-3",
		"USN-6895-4",
		"USN-6896-1",
		"USN-6896-2",
		"USN-6896-3",
		"USN-6896-4",
		"USN-6896-5",
		"USN-6898-1",
		"USN-6898-2",
		"USN-6898-3",
		"USN-6898-4",
		"USN-6900-1",
		"USN-6917-1",
		"USN-6918-1",
		"USN-6919-1",
		"USN-6926-1",
		"USN-6926-2",
		"USN-6926-3",
		"USN-6927-1",
		"USN-6938-1",
		"USN-7019-1"
	],
	"details": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_unix: Fix garbage collector racing against connect()\n\nGarbage collector does not take into account the risk of embryo getting\nenqueued during the garbage collection. If such embryo has a peer that\ncarries SCM_RIGHTS, two consecutive passes of scan_children() may see a\ndifferent set of children. Leading to an incorrectly elevated inflight\ncount, and then a dangling pointer within the gc_inflight_list.\n\nsockets are AF_UNIX/SOCK_STREAM\nS is an unconnected socket\nL is a listening in-flight socket bound to addr, not in fdtable\nV's fd will be passed via sendmsg(), gets inflight count bumped\n\nconnect(S, addr)\tsendmsg(S, [V]); close(V)\t__unix_gc()\n----------------\t-------------------------\t-----------\n\nNS = unix_create1()\nskb1 = sock_wmalloc(NS)\nL = unix_find_other(addr)\nunix_state_lock(L)\nunix_peer(S) = NS\n\t\t\t// V count=1 inflight=0\n\n \t\t\tNS = unix_peer(S)\n \t\t\tskb2 = sock_alloc()\n\t\t\tskb_queue_tail(NS, skb2[V])\n\n\t\t\t// V became in-flight\n\t\t\t// V count=2 inflight=1\n\n\t\t\tclose(V)\n\n\t\t\t// V count=1 inflight=1\n\t\t\t// GC candidate condition met\n\n\t\t\t\t\t\tfor u in gc_inflight_list:\n\t\t\t\t\t\t  if (total_refs == inflight_refs)\n\t\t\t\t\t\t    add u to gc_candidates\n\n\t\t\t\t\t\t// gc_candidates={L, V}\n\n\t\t\t\t\t\tfor u in gc_candidates:\n\t\t\t\t\t\t  scan_children(u, dec_inflight)\n\n\t\t\t\t\t\t// embryo (skb1) was not\n\t\t\t\t\t\t// reachable from L yet, so V's\n\t\t\t\t\t\t// inflight remains unchanged\n__skb_queue_tail(L, skb1)\nunix_state_unlock(L)\n\t\t\t\t\t\tfor u in gc_candidates:\n\t\t\t\t\t\t  if (u.inflight)\n\t\t\t\t\t\t    scan_children(u, inc_inflight_move_tail)\n\n\t\t\t\t\t\t// V count=1 inflight=2 (!)\n\nIf there is a GC-candidate listening socket, lock/unlock its state. This\nmakes GC wait until the end of any ongoing connect() to that socket. After\nflipping the lock, a possibly SCM-laden embryo is already enqueued. And if\nthere is another embryo coming, it can not possibly carry SCM_RIGHTS. At\nthis point, unix_inflight() can not happen because unix_gc_lock is already\ntaken. Inflight graph remains unaffected.",
	"affected": [
		{
			"package": {
				"ecosystem": "Debian:11",
				"name": "linux",
				"purl": "pkg:deb/debian/linux?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "5.10.216-1"
						}
					]
				}
			],
			"versions": [
				"5.10.103-1",
				"5.10.103-1~bpo10+1",
				"5.10.106-1",
				"5.10.113-1",
				"5.10.120-1",
				"5.10.120-1~bpo10+1",
				"5.10.127-1",
				"5.10.127-2",
				"5.10.127-2~bpo10+1",
				"5.10.136-1",
				"5.10.140-1",
				"5.10.148-1",
				"5.10.149-1",
				"5.10.149-2",
				"5.10.158-1",
				"5.10.158-2",
				"5.10.162-1",
				"5.10.178-1",
				"5.10.178-2",
				"5.10.178-3",
				"5.10.179-1",
				"5.10.179-2",
				"5.10.179-3",
				"5.10.179-4",
				"5.10.179-5",
				"5.10.191-1",
				"5.10.197-1",
				"5.10.205-1",
				"5.10.205-2",
				"5.10.209-1",
				"5.10.209-2",
				"5.10.46-4",
				"5.10.46-5",
				"5.10.70-1",
				"5.10.70-1~bpo10+1",
				"5.10.84-1",
				"5.10.92-1",
				"5.10.92-1~bpo10+1",
				"5.10.92-2"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26923.json"
			}
		},
		{
			"package": {
				"ecosystem": "Debian:12",
				"name": "linux",
				"purl": "pkg:deb/debian/linux?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "6.1.90-1"
						}
					]
				}
			],
			"versions": [
				"6.1.27-1",
				"6.1.37-1",
				"6.1.38-1",
				"6.1.38-2",
				"6.1.38-2~bpo11+1",
				"6.1.38-3",
				"6.1.38-4",
				"6.1.38-4~bpo11+1",
				"6.1.52-1",
				"6.1.55-1",
				"6.1.55-1~bpo11+1",
				"6.1.64-1",
				"6.1.66-1",
				"6.1.67-1",
				"6.1.69-1",
				"6.1.69-1~bpo11+1",
				"6.1.76-1",
				"6.1.76-1~bpo11+1",
				"6.1.82-1",
				"6.1.85-1",
				"6.1.90-1~bpo11+1"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26923.json"
			}
		},
		{
			"package": {
				"ecosystem": "Debian:13",
				"name": "linux",
				"purl": "pkg:deb/debian/linux?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "6.8.9-1"
						}
					]
				}
			],
			"versions": [
				"6.1.106-1",
				"6.1.106-2",
				"6.1.106-3",
				"6.1.112-1",
				"6.1.115-1",
				"6.1.119-1",
				"6.1.123-1",
				"6.1.124-1",
				"6.1.27-1",
				"6.1.37-1",
				"6.1.38-1",
				"6.1.38-2",
				"6.1.38-2~bpo11+1",
				"6.1.38-3",
				"6.1.38-4",
				"6.1.38-4~bpo11+1",
				"6.1.52-1",
				"6.1.55-1",
				"6.1.55-1~bpo11+1",
				"6.1.64-1",
				"6.1.66-1",
				"6.1.67-1",
				"6.1.69-1",
				"6.1.69-1~bpo11+1",
				"6.1.76-1",
				"6.1.76-1~bpo11+1",
				"6.1.82-1",
				"6.1.85-1",
				"6.1.90-1",
				"6.1.90-1~bpo11+1",
				"6.1.94-1",
				"6.1.94-1~bpo11+1",
				"6.1.98-1",
				"6.1.99-1",
				"6.3.1-1~exp1",
				"6.3.11-1",
				"6.3.2-1~exp1",
				"6.3.4-1~exp1",
				"6.3.5-1~exp1",
				"6.3.7-1",
				"6.3.7-1~bpo12+1",
				"6.4.1-1~exp1",
				"6.4.11-1",
				"6.4.13-1",
				"6.4.4-1",
				"6.4.4-1~bpo12+1",
				"6.4.4-2",
				"6.4.4-3",
				"6.4.4-3~bpo12+1",
				"6.4~rc6-1~exp1",
				"6.4~rc7-1~exp1",
				"6.5.1-1~exp1",
				"6.5.10-1",
				"6.5.10-1~bpo12+1",
				"6.5.13-1",
				"6.5.3-1",
				"6.5.3-1~bpo12+1",
				"6.5.6-1",
				"6.5.8-1",
				"6.5~rc4-1~exp1",
				"6.5~rc6-1~exp1",
				"6.5~rc7-1~exp1",
				"6.6.11-1",
				"6.6.13-1",
				"6.6.13-1~bpo12+1",
				"6.6.15-1",
				"6.6.15-2",
				"6.6.3-1~exp1",
				"6.6.4-1~exp1",
				"6.6.7-1~exp1",
				"6.6.8-1",
				"6.6.9-1",
				"6.7-1~exp1",
				"6.7.1-1~exp1",
				"6.7.12-1",
				"6.7.12-1~bpo12+1",
				"6.7.4-1~exp1",
				"6.7.7-1",
				"6.7.9-1",
				"6.7.9-2"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26923.json"
			}
		}
	],
	"references": [
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/2e2a03787f4f0abc0072350654ab0ef3324d9db3"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/343c5372d5e17b306db5f8f3c895539b06e3177f"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/47d8ac011fe1c9251070e1bd64cb10b48193ec51"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/507cc232ffe53a352847893f8177d276c3b532a9"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/a36ae0ec2353015f0f6762e59f4c2dbc0c906423"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/b75722be422c276b699200de90527d01c602ea7c"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/dbdf7bec5c920200077d693193f989cb1513f009"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/e76c2678228f6aec74b305ae30c9374cc2f28a51"
		},
		{
			"type": "WEB",
			"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html"
		},
		{
			"type": "WEB",
			"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html"
		},
		{
			"type": "ADVISORY",
			"url": "https://security-tracker.debian.org/tracker/CVE-2024-26923"
		}
	]
}
