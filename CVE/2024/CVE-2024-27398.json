{
	"schema_version": "1.6.0",
	"id": "CVE-2024-27398",
	"modified": "2024-11-05T11:50:04.475688Z",
	"published": "2024-05-14T15:12:28Z",
	"related": [
		"DLA-3840-1",
		"DLA-3843-1",
		"DSA-5703-1",
		"SUSE-SU-2024:1979-1",
		"SUSE-SU-2024:1983-1",
		"SUSE-SU-2024:2008-1",
		"SUSE-SU-2024:2010-1",
		"SUSE-SU-2024:2011-1",
		"SUSE-SU-2024:2019-1",
		"SUSE-SU-2024:2135-1",
		"SUSE-SU-2024:2183-1",
		"SUSE-SU-2024:2184-1",
		"SUSE-SU-2024:2185-1",
		"SUSE-SU-2024:2189-1",
		"SUSE-SU-2024:2190-1",
		"SUSE-SU-2024:2203-1",
		"SUSE-SU-2024:2719-1",
		"SUSE-SU-2024:2722-1",
		"SUSE-SU-2024:2723-1",
		"SUSE-SU-2024:2724-1",
		"SUSE-SU-2024:2725-1",
		"SUSE-SU-2024:2726-1",
		"SUSE-SU-2024:2734-1",
		"SUSE-SU-2024:2740-1",
		"SUSE-SU-2024:2750-1",
		"SUSE-SU-2024:2751-1",
		"SUSE-SU-2024:2755-1",
		"SUSE-SU-2024:2758-1",
		"SUSE-SU-2024:2759-1",
		"SUSE-SU-2024:2760-1",
		"SUSE-SU-2024:2771-1",
		"SUSE-SU-2024:2773-1",
		"SUSE-SU-2024:2792-1",
		"SUSE-SU-2024:2793-1",
		"SUSE-SU-2024:2815-1",
		"SUSE-SU-2024:2818-1",
		"SUSE-SU-2024:2821-1",
		"SUSE-SU-2024:2822-1",
		"SUSE-SU-2024:2824-1",
		"SUSE-SU-2024:2825-1",
		"SUSE-SU-2024:2827-1",
		"SUSE-SU-2024:2840-1",
		"SUSE-SU-2024:2841-1",
		"SUSE-SU-2024:2843-1",
		"SUSE-SU-2024:2850-1",
		"SUSE-SU-2024:2851-1",
		"SUSE-SU-2024:2852-1",
		"SUSE-SU-2024:2874-1",
		"SUSE-SU-2024:3015-1",
		"SUSE-SU-2024:3034-1",
		"SUSE-SU-2024:3037-1",
		"SUSE-SU-2024:3039-1",
		"SUSE-SU-2024:3043-1",
		"SUSE-SU-2024:3044-1",
		"SUSE-SU-2024:3048-1",
		"SUSE-SU-2024:3318-1",
		"SUSE-SU-2024:3320-1",
		"SUSE-SU-2024:3334-1",
		"SUSE-SU-2024:3336-1",
		"SUSE-SU-2024:3347-1",
		"SUSE-SU-2024:3348-1",
		"SUSE-SU-2024:3349-1",
		"SUSE-SU-2024:3363-1",
		"SUSE-SU-2024:3368-1",
		"SUSE-SU-2024:3370-1",
		"SUSE-SU-2024:3375-1",
		"SUSE-SU-2024:3379-1",
		"SUSE-SU-2024:3399-1",
		"SUSE-SU-2024:3623-1",
		"SUSE-SU-2024:3625-1",
		"SUSE-SU-2024:3631-1",
		"SUSE-SU-2024:3632-1",
		"SUSE-SU-2024:3639-1",
		"SUSE-SU-2024:3642-1",
		"SUSE-SU-2024:3649-1",
		"SUSE-SU-2024:3651-1",
		"SUSE-SU-2024:3652-1",
		"SUSE-SU-2024:3662-1",
		"SUSE-SU-2024:3663-1",
		"SUSE-SU-2024:3679-1",
		"SUSE-SU-2024:3685-1",
		"SUSE-SU-2024:3694-1",
		"SUSE-SU-2024:3695-1",
		"SUSE-SU-2024:3696-1",
		"SUSE-SU-2024:3697-1",
		"SUSE-SU-2024:3700-1",
		"SUSE-SU-2024:3701-1",
		"SUSE-SU-2024:3710-1",
		"SUSE-SU-2024:3793-1",
		"SUSE-SU-2024:3796-1",
		"SUSE-SU-2024:3798-1",
		"SUSE-SU-2024:3803-1",
		"SUSE-SU-2024:3806-1",
		"SUSE-SU-2024:3814-1",
		"SUSE-SU-2024:3815-1",
		"SUSE-SU-2024:3820-1",
		"SUSE-SU-2024:3821-1",
		"SUSE-SU-2024:3829-1",
		"SUSE-SU-2024:3830-1",
		"SUSE-SU-2024:3831-1",
		"SUSE-SU-2024:3837-1",
		"SUSE-SU-2024:3842-1",
		"SUSE-SU-2024:3849-1",
		"SUSE-SU-2024:3851-1",
		"SUSE-SU-2024:3852-1",
		"SUSE-SU-2024:3854-1",
		"SUSE-SU-2024:3855-1",
		"SUSE-SU-2024:3857-1",
		"SUSE-SU-2024:3860-1",
		"SUSE-SU-2024:4180-1",
		"SUSE-SU-2024:4207-1",
		"SUSE-SU-2024:4214-1",
		"SUSE-SU-2024:4216-1",
		"SUSE-SU-2024:4218-1",
		"UBUNTU-CVE-2024-27398",
		"USN-6949-1",
		"USN-6949-2",
		"USN-6950-1",
		"USN-6950-2",
		"USN-6950-3",
		"USN-6950-4",
		"USN-6951-1",
		"USN-6951-2",
		"USN-6951-3",
		"USN-6951-4",
		"USN-6952-1",
		"USN-6952-2",
		"USN-6953-1",
		"USN-6955-1",
		"USN-6956-1",
		"USN-6957-1",
		"USN-6979-1",
		"USN-7019-1",
		"USN-7028-1",
		"USN-7028-2"
	],
	"details": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: Fix use-after-free bugs caused by sco_sock_timeout\n\nWhen the sco connection is established and then, the sco socket\nis releasing, timeout_work will be scheduled to judge whether\nthe sco disconnection is timeout. The sock will be deallocated\nlater, but it is dereferenced again in sco_sock_timeout. As a\nresult, the use-after-free bugs will happen. The root cause is\nshown below:\n\n    Cleanup Thread               |      Worker Thread\nsco_sock_release                 |\n  sco_sock_close                 |\n    __sco_sock_close             |\n      sco_sock_set_timer         |\n        schedule_delayed_work    |\n  sco_sock_kill                  |    (wait a time)\n    sock_put(sk) //FREE          |  sco_sock_timeout\n                                 |    sock_hold(sk) //USE\n\nThe KASAN report triggered by POC is shown below:\n\n[   95.890016] ==================================================================\n[   95.890496] BUG: KASAN: slab-use-after-free in sco_sock_timeout+0x5e/0x1c0\n[   95.890755] Write of size 4 at addr ffff88800c388080 by task kworker/0:0/7\n...\n[   95.890755] Workqueue: events sco_sock_timeout\n[   95.890755] Call Trace:\n[   95.890755]  <TASK>\n[   95.890755]  dump_stack_lvl+0x45/0x110\n[   95.890755]  print_address_description+0x78/0x390\n[   95.890755]  print_report+0x11b/0x250\n[   95.890755]  ? __virt_addr_valid+0xbe/0xf0\n[   95.890755]  ? sco_sock_timeout+0x5e/0x1c0\n[   95.890755]  kasan_report+0x139/0x170\n[   95.890755]  ? update_load_avg+0xe5/0x9f0\n[   95.890755]  ? sco_sock_timeout+0x5e/0x1c0\n[   95.890755]  kasan_check_range+0x2c3/0x2e0\n[   95.890755]  sco_sock_timeout+0x5e/0x1c0\n[   95.890755]  process_one_work+0x561/0xc50\n[   95.890755]  worker_thread+0xab2/0x13c0\n[   95.890755]  ? pr_cont_work+0x490/0x490\n[   95.890755]  kthread+0x279/0x300\n[   95.890755]  ? pr_cont_work+0x490/0x490\n[   95.890755]  ? kthread_blkcg+0xa0/0xa0\n[   95.890755]  ret_from_fork+0x34/0x60\n[   95.890755]  ? kthread_blkcg+0xa0/0xa0\n[   95.890755]  ret_from_fork_asm+0x11/0x20\n[   95.890755]  </TASK>\n[   95.890755]\n[   95.890755] Allocated by task 506:\n[   95.890755]  kasan_save_track+0x3f/0x70\n[   95.890755]  __kasan_kmalloc+0x86/0x90\n[   95.890755]  __kmalloc+0x17f/0x360\n[   95.890755]  sk_prot_alloc+0xe1/0x1a0\n[   95.890755]  sk_alloc+0x31/0x4e0\n[   95.890755]  bt_sock_alloc+0x2b/0x2a0\n[   95.890755]  sco_sock_create+0xad/0x320\n[   95.890755]  bt_sock_create+0x145/0x320\n[   95.890755]  __sock_create+0x2e1/0x650\n[   95.890755]  __sys_socket+0xd0/0x280\n[   95.890755]  __x64_sys_socket+0x75/0x80\n[   95.890755]  do_syscall_64+0xc4/0x1b0\n[   95.890755]  entry_SYSCALL_64_after_hwframe+0x67/0x6f\n[   95.890755]\n[   95.890755] Freed by task 506:\n[   95.890755]  kasan_save_track+0x3f/0x70\n[   95.890755]  kasan_save_free_info+0x40/0x50\n[   95.890755]  poison_slab_object+0x118/0x180\n[   95.890755]  __kasan_slab_free+0x12/0x30\n[   95.890755]  kfree+0xb2/0x240\n[   95.890755]  __sk_destruct+0x317/0x410\n[   95.890755]  sco_sock_release+0x232/0x280\n[   95.890755]  sock_close+0xb2/0x210\n[   95.890755]  __fput+0x37f/0x770\n[   95.890755]  task_work_run+0x1ae/0x210\n[   95.890755]  get_signal+0xe17/0xf70\n[   95.890755]  arch_do_signal_or_restart+0x3f/0x520\n[   95.890755]  syscall_exit_to_user_mode+0x55/0x120\n[   95.890755]  do_syscall_64+0xd1/0x1b0\n[   95.890755]  entry_SYSCALL_64_after_hwframe+0x67/0x6f\n[   95.890755]\n[   95.890755] The buggy address belongs to the object at ffff88800c388000\n[   95.890755]  which belongs to the cache kmalloc-1k of size 1024\n[   95.890755] The buggy address is located 128 bytes inside of\n[   95.890755]  freed 1024-byte region [ffff88800c388000, ffff88800c388400)\n[   95.890755]\n[   95.890755] The buggy address belongs to the physical page:\n[   95.890755] page: refcount:1 mapcount:0 mapping:0000000000000000 index:0xffff88800c38a800 pfn:0xc388\n[   95.890755] head: order:3 entire_mapcount:0 nr_pages_mapped:0 pincount:0\n[   95.890755] ano\n---truncated---",
	"affected": [
		{
			"package": {
				"ecosystem": "Debian:11",
				"name": "linux",
				"purl": "pkg:deb/debian/linux?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "5.10.218-1"
						}
					]
				}
			],
			"versions": [
				"5.10.103-1",
				"5.10.103-1~bpo10+1",
				"5.10.106-1",
				"5.10.113-1",
				"5.10.120-1",
				"5.10.120-1~bpo10+1",
				"5.10.127-1",
				"5.10.127-2",
				"5.10.127-2~bpo10+1",
				"5.10.136-1",
				"5.10.140-1",
				"5.10.148-1",
				"5.10.149-1",
				"5.10.149-2",
				"5.10.158-1",
				"5.10.158-2",
				"5.10.162-1",
				"5.10.178-1",
				"5.10.178-2",
				"5.10.178-3",
				"5.10.179-1",
				"5.10.179-2",
				"5.10.179-3",
				"5.10.179-4",
				"5.10.179-5",
				"5.10.191-1",
				"5.10.197-1",
				"5.10.205-1",
				"5.10.205-2",
				"5.10.209-1",
				"5.10.209-2",
				"5.10.216-1",
				"5.10.46-4",
				"5.10.46-5",
				"5.10.70-1",
				"5.10.70-1~bpo10+1",
				"5.10.84-1",
				"5.10.92-1",
				"5.10.92-1~bpo10+1",
				"5.10.92-2"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27398.json"
			}
		},
		{
			"package": {
				"ecosystem": "Debian:12",
				"name": "linux",
				"purl": "pkg:deb/debian/linux?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "6.1.94-1"
						}
					]
				}
			],
			"versions": [
				"6.1.27-1",
				"6.1.37-1",
				"6.1.38-1",
				"6.1.38-2",
				"6.1.38-2~bpo11+1",
				"6.1.38-3",
				"6.1.38-4",
				"6.1.38-4~bpo11+1",
				"6.1.52-1",
				"6.1.55-1",
				"6.1.55-1~bpo11+1",
				"6.1.64-1",
				"6.1.66-1",
				"6.1.67-1",
				"6.1.69-1",
				"6.1.69-1~bpo11+1",
				"6.1.76-1",
				"6.1.76-1~bpo11+1",
				"6.1.82-1",
				"6.1.85-1",
				"6.1.90-1",
				"6.1.90-1~bpo11+1",
				"6.1.94-1~bpo11+1"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27398.json"
			}
		},
		{
			"package": {
				"ecosystem": "Debian:13",
				"name": "linux",
				"purl": "pkg:deb/debian/linux?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "6.8.11-1"
						}
					]
				}
			],
			"versions": [
				"6.1.106-1",
				"6.1.106-2",
				"6.1.106-3",
				"6.1.112-1",
				"6.1.115-1",
				"6.1.27-1",
				"6.1.37-1",
				"6.1.38-1",
				"6.1.38-2",
				"6.1.38-2~bpo11+1",
				"6.1.38-3",
				"6.1.38-4",
				"6.1.38-4~bpo11+1",
				"6.1.52-1",
				"6.1.55-1",
				"6.1.55-1~bpo11+1",
				"6.1.64-1",
				"6.1.66-1",
				"6.1.67-1",
				"6.1.69-1",
				"6.1.69-1~bpo11+1",
				"6.1.76-1",
				"6.1.76-1~bpo11+1",
				"6.1.82-1",
				"6.1.85-1",
				"6.1.90-1",
				"6.1.90-1~bpo11+1",
				"6.1.94-1",
				"6.1.94-1~bpo11+1",
				"6.1.98-1",
				"6.1.99-1",
				"6.3.1-1~exp1",
				"6.3.11-1",
				"6.3.2-1~exp1",
				"6.3.4-1~exp1",
				"6.3.5-1~exp1",
				"6.3.7-1",
				"6.3.7-1~bpo12+1",
				"6.4.1-1~exp1",
				"6.4.11-1",
				"6.4.13-1",
				"6.4.4-1",
				"6.4.4-1~bpo12+1",
				"6.4.4-2",
				"6.4.4-3",
				"6.4.4-3~bpo12+1",
				"6.4~rc6-1~exp1",
				"6.4~rc7-1~exp1",
				"6.5.1-1~exp1",
				"6.5.10-1",
				"6.5.10-1~bpo12+1",
				"6.5.13-1",
				"6.5.3-1",
				"6.5.3-1~bpo12+1",
				"6.5.6-1",
				"6.5.8-1",
				"6.5~rc4-1~exp1",
				"6.5~rc6-1~exp1",
				"6.5~rc7-1~exp1",
				"6.6.11-1",
				"6.6.13-1",
				"6.6.13-1~bpo12+1",
				"6.6.15-1",
				"6.6.15-2",
				"6.6.3-1~exp1",
				"6.6.4-1~exp1",
				"6.6.7-1~exp1",
				"6.6.8-1",
				"6.6.9-1",
				"6.7-1~exp1",
				"6.7.1-1~exp1",
				"6.7.12-1",
				"6.7.12-1~bpo12+1",
				"6.7.4-1~exp1",
				"6.7.7-1",
				"6.7.9-1",
				"6.7.9-2",
				"6.8.9-1"
			],
			"ecosystem_specific": {
				"urgency": "not yet assigned"
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27398.json"
			}
		}
	],
	"references": [
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/012363cb1bec5f33a7b94629ab2c1086f30280f2"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/1b33d55fb7355e27f8c82cd4ecd560f162469249"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/3212afd00e3cda790fd0583cb3eaef8f9575a014"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/33a6e92161a78c1073d90e27abe28d746feb0a53"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/483bc08181827fc475643272ffb69c533007e546"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/50c2037fc28df870ef29d9728c770c8955d32178"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/6a18eeb1b3bbc67c20d9609c31dca6a69b4bcde5"
		},
		{
			"type": "WEB",
			"url": "https://git.kernel.org/stable/c/bfab2c1f7940a232cd519e82fff137e308abfd93"
		},
		{
			"type": "ADVISORY",
			"url": "https://security-tracker.debian.org/tracker/CVE-2024-27398"
		}
	]
}
