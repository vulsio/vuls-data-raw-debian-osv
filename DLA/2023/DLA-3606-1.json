{
	"schema_version": "1.6.0",
	"id": "DLA-3606-1",
	"modified": "2023-10-07T19:15:22.613366Z",
	"published": "2023-10-07T00:00:00Z",
	"related": [
		"CVE-2020-11017",
		"CVE-2020-11018",
		"CVE-2020-11019",
		"CVE-2020-11038",
		"CVE-2020-11039",
		"CVE-2020-11040",
		"CVE-2020-11041",
		"CVE-2020-11042",
		"CVE-2020-11043",
		"CVE-2020-11044",
		"CVE-2020-11045",
		"CVE-2020-11046",
		"CVE-2020-11047",
		"CVE-2020-11048",
		"CVE-2020-11049",
		"CVE-2020-11058",
		"CVE-2020-11085",
		"CVE-2020-11086",
		"CVE-2020-11087",
		"CVE-2020-11088",
		"CVE-2020-11089",
		"CVE-2020-11095",
		"CVE-2020-11096",
		"CVE-2020-11097",
		"CVE-2020-11098",
		"CVE-2020-11099",
		"CVE-2020-13396",
		"CVE-2020-13397",
		"CVE-2020-13398",
		"CVE-2020-15103",
		"CVE-2020-4030",
		"CVE-2020-4031",
		"CVE-2020-4032",
		"CVE-2020-4033",
		"CVE-2023-39350",
		"CVE-2023-39351",
		"CVE-2023-39352",
		"CVE-2023-39353",
		"CVE-2023-39354",
		"CVE-2023-39355",
		"CVE-2023-39356",
		"CVE-2023-40181",
		"CVE-2023-40186",
		"CVE-2023-40188",
		"CVE-2023-40567",
		"CVE-2023-40569",
		"CVE-2023-40589"
	],
	"summary": "freerdp2 - security update",
	"details": "\nMultiple vulnerabilties have been found in freelrdp2, a free\nimplementation of the Remote Desktop Protocol (RDP).\nThe vulnerabilties potentially allows buffer overreads, buffer overflows,\ninterger overflows, use-after-free, DoS vectors.\n\n\n* [CVE-2020-4030](https://security-tracker.debian.org/tracker/CVE-2020-4030)\nIn FreeRDP before version 2.1.2, there is an out of bounds read in\n TrioParse. Logging might bypass string length checks due to an\n integer overflow. This is fixed in version 2.1.2.\n* [CVE-2020-4031](https://security-tracker.debian.org/tracker/CVE-2020-4031)\nIn FreeRDP before version 2.1.2, there is a use-after-free in\n gdi\\_SelectObject. All FreeRDP clients using compatibility mode with\n /relax-order-checks are affected. This is fixed in version 2.1.2.\n* [CVE-2020-4032](https://security-tracker.debian.org/tracker/CVE-2020-4032)\nIn FreeRDP before version 2.1.2, there is an integer casting\n vulnerability in update\\_recv\\_secondary\\_order. All clients with\n +glyph-cache /relax-order-checks are affected. This is fixed in\n version 2.1.2.\n* [CVE-2020-4033](https://security-tracker.debian.org/tracker/CVE-2020-4033)\nIn FreeRDP before version 2.1.2, there is an out of bounds read in\n RLEDECOMPRESS. All FreeRDP based clients with sessions with color\n depth < 32 are affected. This is fixed in version 2.1.2.\n* [CVE-2020-11017](https://security-tracker.debian.org/tracker/CVE-2020-11017)\nIn FreeRDP less than or equal to 2.0.0, by providing manipulated\n input a malicious client can create a double free condition and\n crash the server. This is fixed in version 2.1.0.\n* [CVE-2020-11018](https://security-tracker.debian.org/tracker/CVE-2020-11018)\nIn FreeRDP less than or equal to 2.0.0, a possible resource\n exhaustion vulnerability can be performed. Malicious clients could\n trigger out of bound reads causing memory allocation with random\n size. This has been fixed in 2.1.0.\n* [CVE-2020-11019](https://security-tracker.debian.org/tracker/CVE-2020-11019)\nIn FreeRDP less than or equal to 2.0.0, when running with logger set\n to WLOG\\_TRACE, a possible crash of application could occur due to\n a read of an invalid array index. Data could be printed as string to\n local terminal. This has been fixed in 2.1.0.\n* [CVE-2020-11038](https://security-tracker.debian.org/tracker/CVE-2020-11038)\nIn FreeRDP less than or equal to 2.0.0, an Integer Overflow to\n Buffer Overflow exists. When using /video redirection, a manipulated\n server can instruct the client to allocate a buffer with a smaller\n size than requested due to an integer overflow in size calculation.\n With later messages, the server can manipulate the client to write\n data out of bound to the previously allocated buffer. This has been\n patched in 2.1.0.\n* [CVE-2020-11039](https://security-tracker.debian.org/tracker/CVE-2020-11039)\nIn FreeRDP less than or equal to 2.0.0, when using a manipulated\n server with USB redirection enabled (nearly) arbitrary memory can be\n read and written due to integer overflows in length checks. This has\n been patched in 2.1.0.\n* [CVE-2020-11040](https://security-tracker.debian.org/tracker/CVE-2020-11040)\nIn FreeRDP less than or equal to 2.0.0, there is an out-of-bound\n data read from memory in clear\\_decompress\\_subcode\\_rlex, visualized\n on screen as color. This has been patched in 2.1.0.\n* [CVE-2020-11041](https://security-tracker.debian.org/tracker/CVE-2020-11041)\nIn FreeRDP less than or equal to 2.0.0, an outside controlled array\n index is used unchecked for data used as configuration for sound\n backend (alsa, oss, pulse, ...). The most likely outcome is a crash\n of the client instance followed by no or distorted sound or a\n session disconnect. If a user cannot upgrade to the patched version,\n a workaround is to disable sound for the session. This has been\n patched in 2.1.0.\n* [CVE-2020-11042](https://security-tracker.debian.org/tracker/CVE-2020-11042)\nIn FreeRDP greater than 1.1 and before 2.0.0, there is an\n out-of-bounds read in update\\_read\\_icon\\_info. It allows reading a\n attacker-defined amount of client memory (32bit unsigned -> 4GB) to\n an intermediate buffer. This can be used to crash the client or\n store information for later retrieval. This has been patched in\n 2.0.0.\n* [CVE-2020-11043](https://security-tracker.debian.org/tracker/CVE-2020-11043)\nIn FreeRDP less than or equal to 2.0.0, there is an out-of-bounds\n read in rfx\\_process\\_message\\_tileset. Invalid data fed to RFX decoder\n results in garbage on screen (as colors). This has been patched in\n 2.1.0.\n* [CVE-2020-11044](https://security-tracker.debian.org/tracker/CVE-2020-11044)\nIn FreeRDP greater than 1.2 and before 2.0.0, a double free in\n update\\_read\\_cache\\_bitmap\\_v3\\_order crashes the client application if\n corrupted data from a manipulated server is parsed. This has been\n patched in 2.0.0.\n* [CVE-2020-11045](https://security-tracker.debian.org/tracker/CVE-2020-11045)\nIn FreeRDP after 1.0 and before 2.0.0, there is an out-of-bound read\n in in update\\_read\\_bitmap\\_data that allows client memory to be read\n to an image buffer. The result displayed on screen as colour.\n* [CVE-2020-11046](https://security-tracker.debian.org/tracker/CVE-2020-11046)\nIn FreeRDP after 1.0 and before 2.0.0, there is a stream\n out-of-bounds seek in update\\_read\\_synchronize that could lead to a\n later out-of-bounds read.\n* [CVE-2020-11047](https://security-tracker.debian.org/tracker/CVE-2020-11047)\nIn FreeRDP after 1.1 and before 2.0.0, there is an out-of-bounds\n read in autodetect\\_recv\\_bandwidth\\_measure\\_results. A malicious\n server can extract up to 8 bytes of client memory with a manipulated\n message by providing a short input and reading the measurement\n result data. This has been patched in 2.0.0.\n* [CVE-2020-11048](https://security-tracker.debian.org/tracker/CVE-2020-11048)\nIn FreeRDP after 1.0 and before 2.0.0, there is an out-of-bounds\n read. It only allows to abort a session. No data extraction is\n possible. This has been fixed in 2.0.0.\n* [CVE-2020-11049](https://security-tracker.debian.org/tracker/CVE-2020-11049)\nIn FreeRDP after 1.1 and before 2.0.0, there is an out-of-bound read\n of client memory that is then passed on to the protocol parser. This\n has been patched in 2.0.0.\n* [CVE-2020-11058](https://security-tracker.debian.org/tracker/CVE-2020-11058)\nIn FreeRDP after 1.1 and before 2.0.0, a stream out-of-bounds seek\n in rdp\\_read\\_font\\_capability\\_set could lead to a later out-of-bounds\n read. As a result, a manipulated client or server might force a\n disconnect due to an invalid data read. This has been fixed in\n 2.0.0.\n* [CVE-2020-11085](https://security-tracker.debian.org/tracker/CVE-2020-11085)\nIn FreeRDP before 2.1.0, there is an out-of-bounds read in\n cliprdr\\_read\\_format\\_list. Clipboard format data read (by client or\n server) might read data out-of-bounds. This has been fixed in 2.1.0.\n* [CVE-2020-11086](https://security-tracker.debian.org/tracker/CVE-2020-11086)\nIn FreeRDP less than or equal to 2.0.0, there is an out-of-bound\n read in ntlm\\_read\\_ntlm\\_v2\\_client\\_challenge that reads up to 28 bytes\n out-of-bound to an internal structure. This has been fixed in 2.1.0.\n* [CVE-2020-11087](https://security-tracker.debian.org/tracker/CVE-2020-11087)\nIn FreeRDP less than or equal to 2.0.0, there is an out-of-bound\n read in ntlm\\_read\\_AuthenticateMessage. This has been fixed in 2.1.0.\n* [CVE-2020-11088](https://security-tracker.debian.org/tracker/CVE-2020-11088)\nIn FreeRDP less than or equal to 2.0.0, there is an out-of-bound\n read in ntlm\\_read\\_NegotiateMessage. This has been fixed in 2.1.0.\n* [CVE-2020-11089](https://security-tracker.debian.org/tracker/CVE-2020-11089)\nIn FreeRDP before 2.1.0, there is an out-of-bound read in irp\n functions (parallel\\_process\\_irp\\_create, serial\\_process\\_irp\\_create,\n drive\\_process\\_irp\\_write, printer\\_process\\_irp\\_write, rdpei\\_recv\\_pdu,\n serial\\_process\\_irp\\_write). This has been fixed in 2.1.0.\n* [CVE-2020-11095](https://security-tracker.debian.org/tracker/CVE-2020-11095)\nIn FreeRDP before version 2.1.2, an out of bound reads occurs\n resulting in accessing a memory location that is outside of the\n boundaries of the static array PRIMARY\\_DRAWING\\_ORDER\\_FIELD\\_BYTES.\n This is fixed in version 2.1.2\n* [CVE-2020-11096](https://security-tracker.debian.org/tracker/CVE-2020-11096)\nIn FreeRDP before version 2.1.2, there is a global OOB read in\n update\\_read\\_cache\\_bitmap\\_v3\\_order. As a workaround, one can disable\n bitmap cache with -bitmap-cache (default). This is fixed in version\n 2.1.2.\n* [CVE-2020-11097](https://security-tracker.debian.org/tracker/CVE-2020-11097)\nIn FreeRDP before version 2.1.2, an out of bounds read occurs\n resulting in accessing a memory location that is outside of the\n boundaries of the static array PRIMARY\\_DRAWING\\_ORDER\\_FIELD\\_BYTES.\n This is fixed in version 2.1.2.\n* [CVE-2020-11098](https://security-tracker.debian.org/tracker/CVE-2020-11098)\nIn FreeRDP before version 2.1.2, there is an out-of-bound read in\n glyph\\_cache\\_put. This affects all FreeRDP clients with\n `+glyph-cache` option enabled This is fixed in version 2.1.2.\n* [CVE-2020-11099](https://security-tracker.debian.org/tracker/CVE-2020-11099)\nIn FreeRDP before version 2.1.2, there is an out of bounds read in\n license\\_read\\_new\\_or\\_upgrade\\_license\\_packet. A manipulated license\n packet can lead to out of bound reads to an internal buffer. This is\n fixed in version 2.1.2.\n* [CVE-2020-13396](https://security-tracker.debian.org/tracker/CVE-2020-13396)\nIn FreeRDP before version 2.1.2, there is an out of bounds read in\n license\\_read\\_new\\_or\\_upgrade\\_license\\_packet. A manipulated license\n packet can lead to out of bound reads to an internal buffer. This is\n fixed in version 2.1.2.\n* [CVE-2020-13397](https://security-tracker.debian.org/tracker/CVE-2020-13397)\nAn issue was discovered in FreeRDP before 2.1.1. An out-of-bounds\n (OOB) read vulnerability has been detected in security\\_fips\\_decrypt\n in libfreerdp/core/security.c due to an uninitialized value.\n* [CVE-2020-13398](https://security-tracker.debian.org/tracker/CVE-2020-13398)\nAn issue was discovered in FreeRDP before 2.1.1. An out-of-bounds\n (OOB) write vulnerability has been detected in crypto\\_rsa\\_common in\n libfreerdp/crypto/crypto.c.\n* [CVE-2020-15103](https://security-tracker.debian.org/tracker/CVE-2020-15103)\nIn FreeRDP less than or equal to 2.1.2, an integer overflow exists\n due to missing input sanitation in rdpegfx channel. All FreeRDP\n clients are affected. The input rectangles from the server are not\n checked against local surface coordinates and blindly accepted. A\n malicious server can send data that will crash the client later on\n (invalid length arguments to a `memcpy`) This has been fixed in\n 2.2.0. As a workaround, stop using command line arguments /gfx,\n /gfx-h264 and /network:auto\n* [CVE-2023-39350](https://security-tracker.debian.org/tracker/CVE-2023-39350)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. This issue affects Clients\n only. Integer underflow leading to DOS (e.g. abort due to\n `WINPR\\_ASSERT` with default compilation flags). When an insufficient\n blockLen is provided, and proper length validation is not performed,\n an Integer Underflow occurs, leading to a Denial of Service (DOS)\n vulnerability. This issue has been addressed in versions 2.11.0 and\n 3.0.0-beta3. Users are advised to upgrade. There are no known\n workarounds for this vulnerability.\n* [CVE-2023-39351](https://security-tracker.debian.org/tracker/CVE-2023-39351)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions of\n FreeRDP are subject to a Null Pointer Dereference leading a crash in\n the RemoteFX (rfx) handling. Inside the\n `rfx\\_process\\_message\\_tileset` function, the program allocates tiles\n using `rfx\\_allocate\\_tiles` for the number of numTiles. If the\n initialization process of tiles is not completed for various\n reasons, tiles will have a NULL pointer. Which may be accessed in\n further processing and would cause a program crash. This issue has\n been addressed in versions 2.11.0 and 3.0.0-beta3. Users are advised\n to upgrade. There are no known workarounds for this vulnerability.\n* [CVE-2023-39352](https://security-tracker.debian.org/tracker/CVE-2023-39352)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an invalid offset validation leading to Out Of Bound\n Write. This can be triggered when the values `rect->left` and\n `rect->top` are exactly equal to `surface->width` and\n `surface->height`. eg. `rect->left` == `surface->width` &&\n `rect->top` == `surface->height`. In practice this should cause a\n crash. This issue has been addressed in versions 2.11.0 and\n 3.0.0-beta3. Users are advised to upgrade. There are no known\n workarounds for this vulnerability.\n* [CVE-2023-39353](https://security-tracker.debian.org/tracker/CVE-2023-39353)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to a missing offset validation leading to Out Of Bound Read.\n In the `libfreerdp/codec/rfx.c` file there is no offset validation\n in `tile->quantIdxY`, `tile->quantIdxCb`, and `tile->quantIdxCr`. As\n a result crafted input can lead to an out of bounds read access\n which in turn will cause a crash. This issue has been addressed in\n versions 2.11.0 and 3.0.0-beta3. Users are advised to upgrade. There\n are no known workarounds for this vulnerability.\n* [CVE-2023-39354](https://security-tracker.debian.org/tracker/CVE-2023-39354)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an Out-Of-Bounds Read in the `nsc\\_rle\\_decompress\\_data`\n function. The Out-Of-Bounds Read occurs because it processes\n `context->Planes` without checking if it contains data of sufficient\n length. Should an attacker be able to leverage this vulnerability\n they may be able to cause a crash. This issue has been addressed in\n versions 2.11.0 and 3.0.0-beta3. Users are advised to upgrade. There\n are no known workarounds for this vulnerability.\n* [CVE-2023-39355](https://security-tracker.debian.org/tracker/CVE-2023-39355)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Versions of FreeRDP on the\n 3.x release branch before beta3 are subject to a Use-After-Free in\n processing `RDPGFX\\_CMDID\\_RESETGRAPHICS` packets. If\n `context->maxPlaneSize` is 0, `context->planesBuffer` will be freed.\n However, without updating `context->planesBuffer`, this leads to a\n Use-After-Free exploit vector. In most environments this should only\n result in a crash. This issue has been addressed in version\n 3.0.0-beta3 and users of the beta 3.x releases are advised to\n upgrade. There are no known workarounds for this vulnerability.\n* [CVE-2023-39356](https://security-tracker.debian.org/tracker/CVE-2023-39356)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. In affected versions a\n missing offset validation may lead to an Out Of Bound Read in the\n function `gdi\\_multi\\_opaque\\_rect`. In particular there is no code to\n validate if the value `multi\\_opaque\\_rect->numRectangles` is less\n than 45. Looping through `multi\\_opaque\\_rect->`numRectangles without\n proper boundary checks can lead to Out-of-Bounds Read errors which\n will likely lead to a crash. This issue has been addressed in\n versions 2.11.0 and 3.0.0-beta3. Users are advised to upgrade. There\n are no known workarounds for this vulnerability.\n* [CVE-2023-40567](https://security-tracker.debian.org/tracker/CVE-2023-40567)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an Out-Of-Bounds Write in the\n `clear\\_decompress\\_bands\\_data` function in which there is no offset\n validation. Abuse of this vulnerability may lead to an out of bounds\n write. This issue has been addressed in versions 2.11.0 and\n 3.0.0-beta3. Users are advised to upgrade. there are no known\n workarounds for this vulnerability.\n* [CVE-2023-40181](https://security-tracker.debian.org/tracker/CVE-2023-40181)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an Integer-Underflow leading to Out-Of-Bound Read in the\n `zgfx\\_decompress\\_segment` function. In the context of `CopyMemory`,\n it's possible to read data beyond the transmitted packet range and\n likely cause a crash. This issue has been addressed in versions\n 2.11.0 and 3.0.0-beta3. Users are advised to upgrade. There are no\n known workarounds for this issue.\n* [CVE-2023-40186](https://security-tracker.debian.org/tracker/CVE-2023-40186)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an IntegerOverflow leading to Out-Of-Bound Write\n Vulnerability in the `gdi\\_CreateSurface` function. This issue\n affects FreeRDP based clients only. FreeRDP proxies are not affected\n as image decoding is not done by a proxy. This issue has been\n addressed in versions 2.11.0 and 3.0.0-beta3. Users are advised to\n upgrade. There are no known workarounds for this issue.\n* [CVE-2023-40188](https://security-tracker.debian.org/tracker/CVE-2023-40188)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an Out-Of-Bounds Read in the `general\\_LumaToYUV444`\n function. This Out-Of-Bounds Read occurs because processing is done\n on the `in` variable without checking if it contains data of\n sufficient length. Insufficient data for the `in` variable may cause\n errors or crashes. This issue has been addressed in versions 2.11.0\n and 3.0.0-beta3. Users are advised to upgrade. There are no known\n workarounds for this issue.\n* [CVE-2023-40569](https://security-tracker.debian.org/tracker/CVE-2023-40569)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. Affected versions are\n subject to an Out-Of-Bounds Write in the `progressive\\_decompress`\n function. This issue is likely down to incorrect calculations of the\n `nXSrc` and `nYSrc` variables. This issue has been addressed in\n versions 2.11.0 and 3.0.0-beta3. Users are advised to upgrade. there\n are no known workarounds for this vulnerability.\n* [CVE-2023-40589](https://security-tracker.debian.org/tracker/CVE-2023-40589)\nFreeRDP is a free implementation of the Remote Desktop Protocol\n (RDP), released under the Apache license. In affected versions there\n is a Global-Buffer-Overflow in the ncrush\\_decompress function.\n Feeding crafted input into this function can trigger the overflow\n which has only been shown to cause a crash. This issue has been\n addressed in versions 2.11.0 and 3.0.0-beta3. Users are advised to\n upgrade. There are no known workarounds for this issue.\n\n\nFor Debian 10 buster, these problems have been fixed in version\n2.3.0+dfsg1-2+deb10u3.\n\n\nWe recommend that you upgrade your freerdp2 packages.\n\n\nFor the detailed security status of freerdp2 please refer to\nits security tracker page at:\n<https://security-tracker.debian.org/tracker/freerdp2>\n\n\nFurther information about Debian LTS security advisories, how to apply\nthese updates to your system and frequently asked questions can be\nfound at: <https://wiki.debian.org/LTS>\n\n\n",
	"affected": [
		{
			"package": {
				"ecosystem": "Debian:10",
				"name": "freerdp2",
				"purl": "pkg:deb/debian/freerdp2?arch=source"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "2.3.0+dfsg1-2+deb10u3"
						}
					]
				}
			],
			"versions": [
				"2.0.0~git20190204.1.2693389a+dfsg1-1",
				"2.0.0~git20190204.1.2693389a+dfsg1-1+deb10u1",
				"2.0.0~git20190204.1.2693389a+dfsg1-1+deb10u2",
				"2.0.0~git20190204.1.2693389a+dfsg1-2",
				"2.0.0~git20190204.1.2693389a+dfsg1-2~bpo10+1",
				"2.1.1+dfsg1-1",
				"2.1.2+dfsg1-1",
				"2.1.2+dfsg1-2",
				"2.2.0+dfsg1-1",
				"2.2.0+dfsg1-1~bpo10+1",
				"2.3.0+dfsg1-1",
				"2.3.0+dfsg1-1~bpo10+1",
				"2.3.0+dfsg1-2"
			],
			"database_specific": {
				"source": "https://storage.googleapis.com/debian-osv/dla-osv/DLA-3606-1.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://www.debian.org/lts/security/2023/dla-3606"
		}
	]
}
